name: build-psycopg3-layer
on:
 workflow_dispatch:
jobs:
 build:
  runs-on: ubuntu-latest
 
  steps:
   - uses: actions/checkout@v3
   - name: Create layer directory
     run: |
      mkdir python

   - name: Install psycopg3
     run: |
      pip install "psycopg[binary]" -t python/
      
   - name: Zip layer
     run: |
      zip -r psycopg3-layer.zip python

   - name: Upload artifact
     uses: actions/checkout@v3
     with:
       name: psycopg3-layer
       path: psycopg3-layer.zip
    
